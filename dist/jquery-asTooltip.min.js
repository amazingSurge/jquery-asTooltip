/*! jQuery asTooltip - v0.3.0 - 2014-11-17
* https://github.com/amazingSurge/jquery-asTooltip
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a,b,c){"use strict";var d="asTooltip",e=a(c),f=[],g=function(b,c,d,e){var f,g,h,i,j,k=a(b),l=0,m=0;f=e?b:k.offset(),g=e?0:k.outerWidth(),h=e?0:k.outerHeight(),i=c.outerWidth(),j=c.outerHeight();for(var n=0;n<d.length;n++)switch(d[n]){case"left":l=0===n?f.left-i:f.left;break;case"middle":switch(d[0]){case"left":case"right":m=f.top+(h-j)/2;break;case"top":case"bottom":l=f.left+(g-i)/2}break;case"right":l=0===n?f.left+g:f.left+g-i;break;case"top":m=0===n?f.top-j:f.top;break;case"bottom":m=0===n?f.top+h:f.top+h-j}return{left:Math.round(l),top:Math.round(m)}},h=function(b,c,d){var f=a(b),g=f.offset(),h=d.offset(),i="BODY"===d[0].tagName?e.scrollLeft():d.scrollLeft(),j="BODY"===d[0].tagName?e.scrollTop():d.scrollTop(),k="BODY"===d[0].tagName?g:{top:g.top-h.top,left:g.left-h.left},l=f.outerWidth(),m=f.outerHeight(),n=c.outerWidth(),o=c.outerHeight(),p="BODY"===d[0].tagName?e.innerWidth():d.outerWidth(),q="BODY"===d[0].tagName?e.innerHeight():d.outerHeight(),r=[];return o>k.top-j&&r.push("top"),o+m+k.top>j+q&&r.push("bottom"),n>k.left-i&&r.push("left"),n+l+k.left>i+p&&r.push("right"),r},i=a[d]=function(c,d){var e=a(b.body),f=c[0]===b?e:c,g=this.options=a.extend({},i.defaults,d,a(f).data());g.positionContainer=g.positionContainer?a(g.positionContainer):e,g.positionTarget||(g.positionTarget=f),g.showTarget||(g.showTarget=f),g.hideTarget||(g.hideTarget=f),this.$el=a(f),this.namespace=this.options.namespace,g.content=this.getContent(),this.enabled=!0,this.isOpen=!1,this.loadFlag=!1,this.moveFlag=!1,this.showTimer=null,this.hideTimer=null,this.classes={show:this.namespace+"_isShow",isLoading:this.namespace+"_isLoading",active:this.namespace+"_active",enabled:this.namespace+"_enabled"},this.trigger("init"),this.init()};i.prototype={constructor:i,init:function(){var b=this,c=this.options,d=c.showTarget,f=c.hideTarget,g=c.showEvent,h=c.hideEvent;this.$tip=a(c.tpl.replace(/{{namespace}}/g,this.namespace)),this.$loading=a("."+this.namespace+"-loading",this.$tip),this.$content=a("."+this.namespace+"-content",this.$tip),d===f&&g===h?this._bind(d,g,function(a){(this.isOpen?this.hideMethod:this.showMethod).call(this,a)}):(this._bind(d,g,function(a){this.showMethod.call(this,a)}),this._bind(f,h,function(a){this.hideMethod.call(this,a)})),"BODY"===c.positionContainer[0].tagName&&(c.positionAdjustResize&&this._bind(e,"resize",function(){b.isOpen&&b.setPosition()}),c.positionAdjustScroll&&this._bind(e,"scroll",function(){b.isOpen&&b.setPosition()}))},_bind:function(b,c,d,e){if(b&&d&&c.length){var f=e?c:c+"."+e;return a(b).on(f,a.proxy(d,this)),this}},_unbind:function(b,c,d){return b&&a(b).unbind(d?c:c+"."+d),this},parseTpl:function(a){return a.replace("{{namespace}}",self.namespace)},getDelegateOptions:function(){var b={};return this._options&&a.each(this._options,function(a,c){i.defaults[a]!==c&&(b[a]=c)}),b},showMethod:function(c){var e=c instanceof this.constructor?c:a(c.currentTarget).data(d),f=this.options;if(e||(e=new this.constructor(c.currentTarget,this.getDelegateOptions()),a(c.currentTarget).data(d,e)),f.ajax||e.options.content){if(e.isOpen?clearTimeout(e.hideTimer):(clearTimeout(e.showTimer),e.showTimer=setTimeout(function(){a.proxy(e.show,e)()},f.showDelay)),"mouse"===f.positionTarget){if(this.moveFlag)return;this.isFirst=!0,a(b).on("mousemove."+d,a.proxy(this.move,e)),this.moveFlag=!0}"click"===f.hideEvent&&f.hideContainer&&this._bind(f.hideContainer,f.hideEvent,function(b){var c=a(b.target);0===c.closest(e.$el).length&&0===c.closest(e.$tip).length&&e.isOpen&&a.proxy(e.hide,e)()})}},hideMethod:function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(d),e=this.options,f=!1;return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(d,c)),e.ajax||c.options.content?c.isOpen?void("mouse"===e.positionTarget&&this.moveFlag||("click"===e.hideEvent&&e.hideContainer&&this._unbind(e.hideContainer,e.hideEvent),e.hideInactive&&(this._bind(c.$tip,"mouseenter."+d,function(){f=!0}),this._bind(c.$tip,"mouseleave."+d,function(){f=!1,clearTimeout(c.hideTimer),c.hideTimer=setTimeout(function(){a.proxy(c.hide,c)()},c.options.hideDelay),c._unbind(c.$tip,"mouseenter."+d+" mouseleave."+d)})),clearTimeout(c.hideTimer),c.hideTimer=setTimeout(function(){f||a.proxy(c.hide,c)()},e.hideDelay))):void clearTimeout(c.showTimer):void 0},move:function(c){var e=Math.round(c.pageX),f=Math.round(c.pageY),g=this.$el.offset().top,h=this.$el.offset().left,i=this.$el.outerWidth(),j=this.$el.outerHeight();e>=h&&h+i>=e&&f>=g&&g+j>=f?this.options.positionAdjustMouse?this.setPosition(c):this.isFirst&&(this.setPosition(c),this.isFirst=!1):(a(b).off("mousemove."+d),this.moveFlag=!1,this.hideMethod(this.$el.data(d)))},trigger:function(a){var b=Array.prototype.slice.call(arguments,1),c=[this].concat(b);this.$el.trigger(d+"::"+a,c),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var e="on"+a;"function"==typeof this.options[e]&&this.options[e].apply(this,b)},getContent:function(){return this.$el.attr(this.options.contentAttr)||("function"==typeof this.options.content?this.options.content():this.options.content)},setPosition:function(b){var c,d,e,f=this.options,i=this.$el,j=f.positionContainer,k=!1,l=!1;e=j.css("position");var m=f.position.split(" ");if("mouse"===f.positionTarget&&b?(i={top:Math.round(b.pageY),left:Math.round(b.pageX)},l=!0):"object"==typeof f.positionTarget&&(i=f.positionTarget),f.autoPosition&&"mouse"!==f.positionTarget){var n=h(i,this.$tip,j),o=["top","right","bottom","left"];a.each(n,function(b,c){o=a.map(o,function(a){return a!==c?a:null})}),o.length>0&&(m[0]=o[0])}this.$tip.addClass(this.namespace+"-element-"+m[0]).addClass(this.namespace+"-arrow-"+m[1]),c=g(i,this.$tip,m,l),"static"!==e&&(d=j.offset(),k=!0),this.$tip.css({top:c.top+(k?-d.top:0),left:c.left+(k?-d.left:0)})},loadToggle:function(){var a=this.loadFlag;a?(this.$tip.removeClass(this.namespace+"_isLoading"),a=!1):(this.$tip.addClass(this.namespace+"_isLoading"),a=!0)},statusToggle:function(a){a?this.$el.removeClass(this.classes.active):this.$el.addClass(this.classes.active)},adjustmouse:function(){},adjustResize:function(){},adjustScroll:function(){},rePosition:function(a){return this.setPosition(a),this},setContent:function(){var a=this.options;a.ajax&&this.loadToggle(),this.$content.html(a.content),this.$tip.appendTo(a.positionContainer),"mouse"!==a.positionTarget&&this.setPosition()},show:function(){var a=this.options;if(this.enabled)return a.skin&&this.$tip.addClass(this.namespace+"_"+a.skin),a.ajax&&a.ajax(this),this.setContent(this.isOpen),this.statusToggle(this.isOpen),this.isOpen=!0,this.trigger("show"),this},hide:function(){return this.options.ajax&&this.loadToggle(),this.$tip.off("."+d),this.statusToggle(this.isOpen),this.$tip.remove(),this.isOpen=!1,this.trigger("hide"),this},enable:function(){return this.enabled=!0,this.$el.addClass(this.classes.enabled),this},disable:function(){return this.enabled=!1,this.$el.removeClass(this.classes.enabled),this},destroy:function(){this.$el.off("."+d)}},i.closeAll=function(){f.map(function(a){a.isOpen&&a.hide()})},i.defaults={namespace:d,skin:"dream",closeBtn:!1,position:"right middle",autoPosition:!1,positionTarget:!1,positionContainer:!1,positionAdjustMouse:!0,positionAdjustResize:!0,positionAdjustScroll:!0,showTarget:!1,showEvent:"mouseenter",showDelay:0,hideTarget:!1,hideEvent:"mouseleave",hideDelay:0,hideContainer:!1,hideInactive:!1,content:null,contentAttr:"title",ajax:!1,tpl:'<div class="{{namespace}}"><div class="{{namespace}}-inner"><div class="{{namespace}}-loading"></div><div class="{{namespace}}-content"></div></div></div>',onInit:null,onShow:null,onHide:null,onFocus:null,onBlur:null},a.fn[d]=function(b){if("string"!=typeof b)return this.each(function(){a.data(this,d)||a.data(this,d,new i(this,b))});var c=b,e=Array.prototype.slice.call(arguments,1);if(/^\_/.test(c))return!1;if(!/^(get)/.test(c))return this.each(function(){var b=a.data(this,d);b&&"function"==typeof b[c]&&b[c].apply(b,e)});var f=this.first().data(d);return f&&"function"==typeof f[c]?f[c].apply(f,e):void 0}}(jQuery,document,window);