/*! jQuery asTooltip - v0.3.0 - 2014-10-29
* https://github.com/amazingSurge/jquery-asTooltip
* Copyright (c) 2014 amazingSurge; Licensed GPL */
!function(a,b,c,d){"use strict";function e(a,b,c,d,e,f){var g,h,i,j=0,k=0;switch(f?(g=a,h=0,i=0):(g=a.offset(),h=a.outerWidth(),i=a.outerHeight()),b){case"n":j=g.left+h/2-c/2,k=g.top-d-e;break;case"e":j=g.left+h+e,k=g.top+i/2-d/2;break;case"s":j=g.left+h/2-c/2,k=g.top+i+e;break;case"w":j=g.left-c-e,k=g.top+i/2-d/2;break;case"nw":case"wn":j=g.left-c+20,k=g.top-d-e;break;case"ne":case"en":j=g.left+h-20,k=g.top-d-e;break;case"sw":case"ws":j=g.left-c+20,k=g.top+i+e;break;case"se":case"es":j=g.left+h-20,k=g.top+i+e}return{left:Math.round(j),top:Math.round(k)}}function f(a,b){var c,d,e=h.scrollLeft(),f=h.scrollTop(),g=a.offset(),i=a.outerWidth(),j=a.outerHeight(),k=h.width(),l=h.height(),m=[];return b?(c=b.outerWidth(!0),d=b.outerHeight(!0)):(c=100,d=50),g.top<f+d&&m.push("n"),g.top+j+d>f+l&&m.push("s"),g.left<e+c&&m.push("w"),g.left+i+c>e+k&&m.push("e"),m}var g="asTooltip",h=a(c),i=[],j="nswe",k={n:{n:"s",w:"ne",e:"nw"},s:{s:"n",w:"se",e:"sw"},w:{w:"e",n:"sw",s:"nw"},e:{e:"w",n:"se",s:"ne"},nw:{n:"sw",w:"ne"},ne:{n:"se",e:"nw"},sw:{s:"nw",w:"se"},se:{s:"ne",e:"sw"}},l=a[g]=function(b,c){this.$element=a(b),this.options=a.extend({},l.defaults,c,this.$element.data()),this.namespace=this.options.namespace,this.content=null,this.$target=this.$element,this.isOpen=!1,this.enabled=!0,this.tolerance=null,this.classes={active:this.namespace+"-active",enabled:this.namespace+"-enabled"},this.onlyOne=this.options.onlyOne,this._trigger("init"),this.init()};l.prototype={constructor:l,init:function(){var b=this.parseTpl(this.options.tpl);this.$tip=a(b.tip),this.$loading=a(b.loading),this.$arrow=a(b.arrow),this.$close=a(b.close),this.$content=a(b.content),"hover"===this.options.trigger&&(this.$target.on("mouseenter."+g,this.options.selector,a.proxy(this.enter,this)),this.$target.on("mouseleave."+g,this.options.selector,a.proxy(this.leave,this)),this.options.mouseTrace===!0&&this.$target.on("mousemove."+g,this.options.selector,a.proxy(this.move,this))),"click"===this.options.trigger&&this.$target.on("click."+g,this.options.selector,a.proxy(this.toggle,this)),this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixContent(),i.push(this),this._trigger("ready")},getDelegateOptions:function(){var b={};return this._options&&a.each(this._options,function(a,c){l.defaults[a]!==c&&(b[a]=c)}),b},fixContent:function(){var a=this.$element,b=this.options.contentAttr;(a.attr(b)||"string"!=typeof a.attr("data-original-content"))&&a.attr("data-original-content",a.attr(b)||"").attr(b,"")},getContent:function(){var a=this.$element.attr("data-original-content")||("function"==typeof this.options.content?this.options.content.call(this.$element[0]):this.options.content);return a},enter:function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(g);return c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(g,c)),c.isOpen===!0?void clearTimeout(c.tolerance):void a.proxy(c.show,c)()},leave:function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(g);if(c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(g,c)),c.options.interactive===!0){var d=!1;c.$tip.on("mouseenter."+g,function(){d=!0}),c.$tip.on("mouseleave."+g,function(){d=!1}),clearTimeout(c.tolerance),c.tolerance=setTimeout(function(){d===!0?c.$tip.on("mouseleave."+g,a.proxy(c.hide,c)):a.proxy(c.hide,c)()},c.options.interactiveDelay)}else a.proxy(c.hide,c)()},toggle:function(b){var c=b instanceof this.constructor?b:a(b.currentTarget).data(g);c||(c=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(g,c)),c.isOpen===!0?a.proxy(c.hide,c)():a.proxy(c.show,c)()},move:function(b){var c,d={},f=b.pageX,h=b.pageY,i=b instanceof this.constructor?b:a(b.currentTarget).data(g);i||(i=new this.constructor(b.currentTarget,this.getDelegateOptions()),a(b.currentTarget).data(g,i)),d={top:h,left:f},c=e(d,i.options.position,i.width,i.height,i.options.distance,!0),i.$tip.css({display:"block",top:c.top,left:c.left})},load:function(){var b=this,c=this.options,d=this.getContent();c.ajax===!0?a.ajax(a.extend({},c.ajaxSettings,{url:d,error:function(){throw new Error("ajax error")},success:function(a,c){"success"===c&&(b.content=a,b.$tip.css({display:"none"}),b.$content.empty().append(b.content),b.$tip.removeClass(b.positionClass),b.setPosition())}})):this.content=c.inline===!0?d&&-1!==d.indexOf("+")?this.$element.next().css({display:"block"}):a(d).css({display:"block"}):d},parseTpl:function(b){var c={},d=this;return a.each(b,function(a,b){c[a]=b.replace("{{namespace}}",d.namespace)}),c},showLoading:function(){this.$content.empty(),this.$loading.css({display:"block"})},hideLoading:function(){this.$loading.css({display:"none"})},setPosition:function(){var b,c=this.options,g=this.namespace+"-"+c.position;if(this.width=this.$tip.outerWidth(),this.height=this.$tip.outerHeight(),c.mouseTrace!==!0){if(c.autoPosition===!0){var h,i=[];if(i=c.ajax===!0&&null===this.content?f(this.$target):f(this.$target,this.$tip),0===i.length)h=c.position;else if(1===i.length){var l=k[c.position][i[0]];h=l===d?c.position:l}else{var m=j;a.each(i,function(a,b){m.replace(b,"")}),h=m}g=this.namespace+"-"+h,b=e(this.$target,h,this.width,this.height,this.options.distance)}else b=e(this.$target,c.position,this.width,this.height,this.options.distance);this.$tip.css({display:"block",top:b.top,left:b.left})}this.positionClass=g,this.$tip.addClass(g)},_trigger:function(a){var b=Array.prototype.slice.call(arguments,1),c=[this].concat(b);this.$element.trigger(g+"::"+a,c),a=a.replace(/\b\w+\b/g,function(a){return a.substring(0,1).toUpperCase()+a.substring(1)});var d="on"+a;"function"==typeof this.options[d]&&this.options[d].apply(this,b)},show:function(){var b=this.options,c=this;if(this.enabled)return this.onlyOne&&a.each(i,function(a,b){b!==c&&b.isOpen&&b.hide()}),this.$tip=a(this.options.tpl.tip.replace("{{namespace}}",this.namespace)),b.closeBtn&&this.$tip.append(this.$close),this.$tip.append(this.$arrow).append(this.$content),this.$element.addClass(this.classes.active),null===this.content&&this.load(),null===this.content?this.$content.append(this.$loading):this.$content.empty().append(this.content),b.skin&&this.$tip.addClass(this.namespace+"_"+b.skin),this.$tip.css({display:"none"}),this.options.container?this.$tip.appendTo(this.options.container):this.$tip.insertAfter(this.$element),this.setPosition(),this._trigger("show"),this.isOpen=!0,this},hide:function(){this.$tip.off("."+g),this._trigger("hide"),this.$element.removeClass(this.classes.active),this.$tip.remove(),this.isOpen=!1},setContent:function(a){this.content=a},enable:function(){return this.enabled=!0,this.$element.addClass(this.classes.enabled),this},disable:function(){return this.enabled=!1,this.$element.removeClass(this.classes.enabled),this},destroy:function(){this.$target.off("."+g)}},l.closeAll=function(){i.map(function(a){a.isOpen&&a.hide()})},l.defaults={namespace:g,skin:null,onlyOne:!1,trigger:"hover",interactive:!1,interactiveDelay:500,mouseTrace:!1,closeBtn:!1,selector:!1,container:"body",distance:10,position:"n",autoPosition:!0,delay:0,effect:"fade",duration:200,inline:!1,content:null,contentAttr:"title",ajax:!1,ajaxSettings:{dataType:"html",headers:{tooltip:!0}},tpl:{tip:'<div class="{{namespace}}"></div>',loading:'<span class="{{namespace}}-loading"></span>',content:'<div class="{{namespace}}-content"></div>',arrow:'<span class="{{namespace}}-arrow"></span>',close:'<a class="{{namespace}}-close"></a>'}},a.fn[g]=function(b){if("string"!=typeof b)return this.each(function(){a.data(this,g)||a.data(this,g,new l(this,b))});var c=b,d=Array.prototype.slice.call(arguments,1);if(/^\_/.test(c))return!1;if(!/^(get)/.test(c))return this.each(function(){var b=a.data(this,g);b&&"function"==typeof b[c]&&b[c].apply(b,d)});var e=this.first().data(g);return e&&"function"==typeof e[c]?e[c].apply(e,d):void 0}}(jQuery,document,window);